{
  "operators": {
    "load1": {
       "type": "TableLoad",
       "table": "ORDER-LINE"
    },
    "load2": {
       "type": "TableLoad",
       "table": "STOCK",
       "filename": "tpcc/stock.csv",
       "header": "tpcc/stock_header.tbl"
    },
    "join": {
       "type":"JoinScan",
       "predicates": [{"type": 3,
                       "input_left": 0,
                       "field_left": "OL_I_ID",
                       "input_right": 1,
                       "field_right": "S_I_ID"}]
    },
    "select": {
       "type": "SimpleTableScan",
       "predicates": [
         {"type": "AND"},
         {"type": "EQ", "in": 0, "f": "OL_W_ID", "vtype": 0 /*Int*/, "value": :w_id},
         {"type": "AND"},
         {"type": "EQ", "in": 0, "f": "OL_D_ID", "vtype": 0 /*Int*/, "value": :d_id},
         {"type": "AND"},
         {"type": "BETWEEN", "in": 0, "f": "OL_O_ID", "vtype": 0 /*Int*/, "value": :o_id1, "value2": :o_id2},
         {"type": "AND"},
         {"type": "EQ", "in": 0, "f": "S_W_ID", "vtype": 0 /*Int*/, "value": :w_id},
         {"type": "LT", "in": 0, "f": "S_QUANTITY", "vtype": 0 /*Int*/, "value": :threshold},
       ]
    },
    "hash": {
       "type": "HashBuild",
       "fields": ["year"],
       "key": "groupby"
    },
    "groupby": {
       "type": "GroupByScan",
       "fields": ["year"],
       "functions": [
         {"type": "COUNT", "field": "date", "distinct": true, "as": "count_distinct"},
       ]
    },
    "project": {
       "type": "ProjectionScan",
       "fields": ["W_TAX"]
    }
  },
  "edges": [["load1", "join"], ["load2", "join"], ["join", "select"],
            ["select", "hash"], ["select", "groupby"], ["hash", "groupby"],
            ["groupby", "project"]]
}
